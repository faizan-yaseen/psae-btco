<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Sally&#39;s Flower Shop - Part 7 | Backend Technical Consultant Onboarding (BTCO)</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Exercises, codes and solutions for the BTCO training program">
    
    <link rel="preload" href="/psae-btco/assets/css/0.styles.ae6c4b4b.css" as="style"><link rel="preload" href="/psae-btco/assets/js/app.d63afb61.js" as="script"><link rel="preload" href="/psae-btco/assets/js/2.3969ddc5.js" as="script"><link rel="preload" href="/psae-btco/assets/js/13.0fc82dc5.js" as="script"><link rel="preload" href="/psae-btco/assets/js/5.6d5f03cc.js" as="script"><link rel="prefetch" href="/psae-btco/assets/js/10.5bcde458.js"><link rel="prefetch" href="/psae-btco/assets/js/11.cf8f5c7a.js"><link rel="prefetch" href="/psae-btco/assets/js/12.9b295f8f.js"><link rel="prefetch" href="/psae-btco/assets/js/14.2e0c10cb.js"><link rel="prefetch" href="/psae-btco/assets/js/15.c65f983f.js"><link rel="prefetch" href="/psae-btco/assets/js/16.89195d07.js"><link rel="prefetch" href="/psae-btco/assets/js/17.1a7e901b.js"><link rel="prefetch" href="/psae-btco/assets/js/18.d0f79296.js"><link rel="prefetch" href="/psae-btco/assets/js/19.e238475a.js"><link rel="prefetch" href="/psae-btco/assets/js/20.c1014938.js"><link rel="prefetch" href="/psae-btco/assets/js/21.88562d51.js"><link rel="prefetch" href="/psae-btco/assets/js/22.550cd687.js"><link rel="prefetch" href="/psae-btco/assets/js/23.65c8ca17.js"><link rel="prefetch" href="/psae-btco/assets/js/24.7fd49ae9.js"><link rel="prefetch" href="/psae-btco/assets/js/25.2466cc21.js"><link rel="prefetch" href="/psae-btco/assets/js/26.0896e2ab.js"><link rel="prefetch" href="/psae-btco/assets/js/27.137735d7.js"><link rel="prefetch" href="/psae-btco/assets/js/28.0a0cdb1a.js"><link rel="prefetch" href="/psae-btco/assets/js/29.d6730b7b.js"><link rel="prefetch" href="/psae-btco/assets/js/3.7f90f6a6.js"><link rel="prefetch" href="/psae-btco/assets/js/30.3a3765e2.js"><link rel="prefetch" href="/psae-btco/assets/js/4.bcf7b13f.js"><link rel="prefetch" href="/psae-btco/assets/js/6.3ab397f0.js"><link rel="prefetch" href="/psae-btco/assets/js/7.a39ec6a2.js"><link rel="prefetch" href="/psae-btco/assets/js/8.87f68678.js"><link rel="prefetch" href="/psae-btco/assets/js/9.d1355fc0.js">
    <link rel="stylesheet" href="/psae-btco/assets/css/0.styles.ae6c4b4b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/psae-btco/" class="home-link router-link-active"><!----> <span class="site-name">Backend Technical Consultant Onboarding (BTCO)</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/psae-btco/" aria-current="page" class="sidebar-link">Howdy Partner</a></li><li><section class="sidebar-group depth-0"><a href="/psae-btco/" class="sidebar-heading clickable router-link-active"><span>Exercises</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/psae-btco/" class="sidebar-heading clickable router-link-active open"><span>Sally's Flower Shop</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/psae-btco/exercises/flower_shop.html" class="sidebar-link">Part 1</a></li><li><a href="/psae-btco/exercises/flower_shop_2.html" class="sidebar-link">Part 2</a></li><li><a href="/psae-btco/exercises/flower_shop_3.html" class="sidebar-link">Part 3</a></li><li><a href="/psae-btco/exercises/flower_shop_4.html" class="sidebar-link">Part 4</a></li><li><a href="/psae-btco/exercises/flower_shop_5.html" class="sidebar-link">Part 5</a></li><li><a href="/psae-btco/exercises/flower_shop_6.html" class="sidebar-link">Part 6</a></li><li><a href="/psae-btco/exercises/flower_shop_7.html" class="sidebar-link">Part 7</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/psae-btco/" class="sidebar-heading clickable router-link-active"><span>Awesome School</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/psae-btco/" class="sidebar-heading clickable router-link-active"><span>Realty Management</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/psae-btco/" class="sidebar-heading clickable router-link-active open"><span>Solutions</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/psae-btco/" class="sidebar-heading clickable router-link-active open"><span>Sally's Flower Shop</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/psae-btco/solutions/flower_shop.html" class="sidebar-link">Part 1</a></li><li><a href="/psae-btco/solutions/flower_shop_2.html" class="sidebar-link">Part 2</a></li><li><a href="/psae-btco/solutions/flower_shop_3.html" class="sidebar-link">Part 3</a></li><li><a href="/psae-btco/solutions/flower_shop_4.html" class="sidebar-link">Part 4</a></li><li><a href="/psae-btco/solutions/flower_shop_5.html" class="sidebar-link">Part 5</a></li><li><a href="/psae-btco/solutions/flower_shop_6.html" class="sidebar-link">Part 6</a></li><li><a href="/psae-btco/solutions/flower_shop_7.html" aria-current="page" class="active sidebar-link">Part 7</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sally-s-flower-shop-part-7"><a href="#sally-s-flower-shop-part-7" class="header-anchor">#</a> Sally's Flower Shop - Part 7</h1> <p><a href="https://github.com/odoo-ps/psae-btco/commit/fa5702bf02f01779fc9b65bb8c81168fbd6862f4" target="_blank" rel="noopener noreferrer">View the commit for this solution<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>In this exercise, we will learn how RESTful APIs can be integrated with Odoo. Please ensure that you have an account
created at <a href="https://openweathermap.org" target="_blank" rel="noopener noreferrer">Open Weather Map<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> website.</p> <h3 id="system-parameters"><a href="#system-parameters" class="header-anchor">#</a> System Parameters</h3> <p>Typically, in an API integration, we are provided an API key that is bound to our account. This key is private
information and should be set by the admin user only, and it should be a constant. As such, we will create an XML record
in the model <code>ir.config_parameter</code> which uses a <code>key</code> field and a <code>value</code> field.</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>odoo</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">noupdate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ir.config_parameter<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ir_config_parameter_weather_api_key<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>field</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>key<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>flower_shop.weather_api_key<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>field</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>field</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>unset<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>field</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>odoo</span><span class="token punctuation">&gt;</span></span>u
</code></pre></div><div style="display:inline-flex;margin-bottom:12px;" data-v-37099482><button data-v-37099482><div data-v-37099482>View Code</div></button></div> <p>Since the API key will be different and specific for each database, we must <strong>never</strong> set our API key in the XML record.
Instead, we will set it via the user interface/frontend.</p> <p><img src="/psae-btco/assets/img/part-7-img-1.6749024b.png" alt="System parameter for API key"></p> <h3 id="api-call-parameters"><a href="#api-call-parameters" class="header-anchor">#</a> API Call Parameters</h3> <p>We will implement a Python method in the <code>stock.warehouse</code> model that will make an API call whenever a button is
clicked. It will then fetch the weather data for the location of the current warehouse. The location is specified in
terms of latitude and longitude. Fortunately, Odoo has these fields available in the <code>res.partner</code> model which means we
somehow need a <code>many2one</code> field of this model inside warehouse records. Therefore, we will use the <code>partner_id</code> field
in <code>stock.warehouse</code> that will serve as the warehouse's location.</p> <p>Besides the coordinates, we also need to fetch the API key to make our first call. This is easily retrieved from
the <code>ir.config_parameter</code> model using <code>get_param</code> and specifying the key. Moreover, the use of <code>sudo</code> is advised to
bypass any access rights restriction (unless you know what you are doing and really do want to check access rights).</p> <p>The use of <code>_logger</code> and <code>show_error</code> will be explained later.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">_get_api_key_and_location</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> show_error<span class="token punctuation">)</span><span class="token punctuation">:</span>
    api_key <span class="token operator">=</span> self<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">&quot;ir.config_parameter&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sudo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_param<span class="token punctuation">(</span><span class="token string">&quot;flower_shop.weather_api_key&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> api_key <span class="token operator">==</span> <span class="token string">&quot;unset&quot;</span> <span class="token keyword">or</span> <span class="token keyword">not</span> api_key<span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>partner_id <span class="token keyword">or</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>partner_id<span class="token punctuation">.</span>partner_latitude <span class="token keyword">or</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>partner_id<span class="token punctuation">.</span>partner_longitude<span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> api_key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>partner_id<span class="token punctuation">.</span>partner_latitude<span class="token punctuation">,</span> self<span class="token punctuation">.</span>partner_id<span class="token punctuation">.</span>partner_longitude
</code></pre></div><div style="display:inline-flex;margin-bottom:12px;" data-v-37099482><button data-v-37099482><div data-v-37099482>View Code</div></button></div> <h3 id="http-get-request"><a href="#http-get-request" class="header-anchor">#</a> HTTP GET Request</h3> <p>Making HTTP requests are super easy in Python. We will create the necessary URL and make a GET request to the endpoint
provided by the API. It is always a good idea to surround the request within a <em>try/catch</em> block for error handling.
Next, after studying the response structure from the provider's site, we can retrieve all the information needed and
create a <code>stock.warehouse.weather</code> record.</p> <p>We use <code>self.ensure_one()</code> whenever we have to ensure that <code>self</code> contains exactly one record. In case it is empty or
contains multiple records, an exception will be raised. In our case, we want to make sure that the weather data are
fetched for one warehouse/location only.</p> <div class="language-python extra-class"><pre class="language-python"><code> <span class="token keyword">def</span> <span class="token function">get_weather</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> show_error<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>ensure_one<span class="token punctuation">(</span><span class="token punctuation">)</span>
    api_key<span class="token punctuation">,</span> lat<span class="token punctuation">,</span> lng <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_api_key_and_location<span class="token punctuation">(</span>show_error<span class="token punctuation">)</span>
    url <span class="token operator">=</span> <span class="token string">&quot;https://api.openweathermap.org/data/2.5/weather?lat={}&amp;lon={}&amp;appid={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lat<span class="token punctuation">,</span> lng<span class="token punctuation">,</span> api_key<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        response<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
        entries <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">&quot;stock.warehouse.weather&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">&quot;warehouse_id&quot;</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
            <span class="token string">&quot;description&quot;</span><span class="token punctuation">:</span> entries<span class="token punctuation">[</span><span class="token string">&quot;weather&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;description&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;pressure&quot;</span><span class="token punctuation">:</span> entries<span class="token punctuation">[</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;pressure&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;temperature&quot;</span><span class="token punctuation">:</span> entries<span class="token punctuation">[</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;temp&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;humidity&quot;</span><span class="token punctuation">:</span> entries<span class="token punctuation">[</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;humidity&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">,</span>
            <span class="token string">&quot;wind_speed&quot;</span><span class="token punctuation">:</span> entries<span class="token punctuation">[</span><span class="token string">&quot;wind&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;speed&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;rain_volume&quot;</span><span class="token punctuation">:</span> entries<span class="token punctuation">[</span><span class="token string">&quot;rain&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;1h&quot;</span><span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token string">&quot;rain&quot;</span> <span class="token keyword">in</span> entries <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;capture_time&quot;</span><span class="token punctuation">:</span> fields<span class="token punctuation">.</span>Datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><div style="display:inline-flex;margin-bottom:12px;" data-v-37099482><button data-v-37099482><div data-v-37099482>View Code</div></button></div> <h3 id="scheduled-action"><a href="#scheduled-action" class="header-anchor">#</a> Scheduled Action</h3> <p>The previous method needs to get weather data for every warehouse record. This calls for a scheduled action that has to
be hourly. However, there is an issue - we can neither call the method directly as a model method (e.g.
<code>model.get_weather()</code> nor can we call via a recordset, for example, <code>records.get_weather()</code>
or <code>env['stock.warehouse'].search([]).get_weather()</code>. This is due to the fact that it uses <code>self.ensure_one()</code>. As a
workaround, we will create a new method which essentially gets a recordset of all the warehouses and
calls <code>get_weather()</code> for each warehouse record.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_weather_all_warehouses</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> warehouse <span class="token keyword">in</span> self<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        warehouse<span class="token punctuation">.</span>get_weather<span class="token punctuation">(</span>show_error<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div><div style="display:inline-flex;margin-bottom:12px;" data-v-37099482><button data-v-37099482><div data-v-37099482>View Code</div></button></div> <p>We will create a second scheduled action to get the forecast for each warehouse location. The interval of this action is
going to be daily. You can find the two scheduled actions in <code>data/actions.xml</code>.</p> <h3 id="weather-forecast"><a href="#weather-forecast" class="header-anchor">#</a> Weather Forecast</h3> <p>The API call for getting forecast is very similar to the current weather API call. It is important
to study the response that will be sent back, therefore, please check out
this <a href="https://openweathermap.org/forecast5#JSON" target="_blank" rel="noopener noreferrer">example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from the API provider's website.</p> <p>We will define a method that gets forecast data for all warehouses. The first step is make the API call. Once a response
is acquired, we will extract the data we need between 9 AM to 6 PM of the current day and since the API provides 3-hour
interval data, we will look into four entries. In any entry, if the rain volume is more than 0.2 mm, we will
automatically water all the flowers in that warehouse. In order to fetch all the different flower stock in a warehouse,
the model <code>stock.quant</code> is queried. The last step is to call a method we had previously defined on all the serial-numbered
flowers to water them.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_forecast_all_warehouses</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> show_error<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><div style="display:inline-flex;margin-bottom:12px;" data-v-37099482><button data-v-37099482><div data-v-37099482>View Code</div></button></div> <p>This marks the completion of part 7 of the case study.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/psae-btco/solutions/flower_shop_6.html" class="prev">
        Part 6
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/psae-btco/assets/js/app.d63afb61.js" defer></script><script src="/psae-btco/assets/js/2.3969ddc5.js" defer></script><script src="/psae-btco/assets/js/13.0fc82dc5.js" defer></script><script src="/psae-btco/assets/js/5.6d5f03cc.js" defer></script>
  </body>
</html>
